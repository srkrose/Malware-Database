@extends('layouts.autopartner')

@section('content')

    @include('includes.main_navigation')

    @if(!is_null($topAd))
    <div class="container">
        <div class="row">
            <div class="col-md-12 category-advertisment-up">
                <a href="#" target="_blank" rel="noopener noreferrer"><img class="d-block mx-auto w-100 rounded-0 shadow p-0" src="/storage/advertisements/{{ $topAd->image }}" alt="Advertisment 1"></a>
            </div>
        </div>
    </div>
    @endif

    <div class="container mt-3">

        <div class="row @if(is_null($topAd)) category-advertisment-up @endif">

        	<div class="col-md-2 hide-on-small">                

                <div class="shadow p-3">
                    <h6>Categories <i class="fa-solid fa-angle-right float-end"></i></h6>
                    @foreach($cs as $cate)
                        <a href="{{ route('category', ['id' => base64_encode($cate->id), 'name' => str_replace(' ', '-', strtolower($cate->seo_title))]) }}" title="{{$cate->seo_title}}" class="d-flex justify-content-between align-items-center ps-2 py-2 side-nav-cate @if($cate->name == $category->name) strong text-dark @else text-secondary @endif">                        
                            {{$cate->name}} <i class="fa-solid fa-caret-right float-end"></i>
                        </a>
                    @endforeach
                </div>

            </div>

            <div class="col-md-10">

                <div class="row">
                    <div class="col-md-12">
                        <div class="shadow p-3">
                            <h1 class="text-dark mb-0 text-capitalize m-0 item-name-title strong">{{$category->page_title}}</h1>
                            <p class="small text-secondary m-0">
                                <a href="/">Home</a>
                                <i class="fa-solid fa-chevron-right"></i>
                                <a href="#">{{$category->name}}</a>
                            </p>
                        </div>
                    </div>
                </div>        

                <div class="row mt-3">            

                    <div class="col-md-9">

                        <div class="row">
                            <div class="col-md-12">
                                <div id="autopartnerCarousel" class="carousel slide shadow" data-bs-ride="carousel">

                                    <!-- Indicators/dots -->
                                    <div class="carousel-indicators">
                                        <button type="button" data-bs-target="#autopartnerCarousel" data-bs-slide-to="0"
                                            class="active"></button>
                                        <button type="button" data-bs-target="#autopartnerCarousel" data-bs-slide-to="1"></button>
                                        <button type="button" data-bs-target="#autopartnerCarousel" data-bs-slide-to="2"></button>
                                    </div>
                
                                    <!-- The slideshow/carousel -->
                                    <div class="carousel-inner rounded-0 shadow">
                                        @php $count = 0; @endphp
                                        @foreach($latest3 as $item)
                                        <div class="category-carousel carousel-item @if($count == 0) active @endif">

                                            <div class="d-flex justify-content-center w-100 h-100">
                                                <img src="/storage/items/{{ $item->cover }}" alt="Auto partner slide 1" class="align-middle">
                                            </div>

                                            <div class="carousel-caption p-3 text-start">
                                                <h2 class="m-0">{{$item->name}}</h2>
                                                <p class="m-0 small">{{ $item->company->city->name }}, {{ $item->company->district->name }}</p>
                                                @if($item->subcategory->category_id != 3)
                                                <p class="m-0 small text-theme-red">{{number_format($item->price, 2)}} LKR</p>
                                                @endif
                                            </div>
                                        </div>
                                        @php $count++; @endphp
                                        @endforeach
                                    </div>
                
                                    <!-- Left and right controls/icons -->
                                    <button class="carousel-control-prev" type="button" data-bs-target="#autopartnerCarousel"
                                        data-bs-slide="prev">
                                        <span class="carousel-control-prev-icon"></span>
                                    </button>
                                    <button class="carousel-control-next" type="button" data-bs-target="#autopartnerCarousel"
                                        data-bs-slide="next">
                                        <span class="carousel-control-next-icon"></span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="row my-3">

                            <div class="col-md-12 mt-2">
                                <div class="d-flex justify-content-center flex-column align-items-center w-100 py-2">
                                    <script type="text/javascript">
                                        atOptions = {
                                            'key' : '06be58498ee6db9bd2c351a50f7a7a2c',
                                            'format' : 'iframe',
                                            'height' : 90,
                                            'width' : 728,
                                            'params' : {}
                                        };
                                    </script>
                                    <script type="text/javascript" src="//www.topcreativeformat.com/06be58498ee6db9bd2c351a50f7a7a2c/invoke.js"></script>
                                </div>
                            </div>

                            @foreach($items as $car)
                                <div class="col-md-6 mt-2">
                                    <div class="shadow mb-2 p-2 bg-white rounded-0">
                                        <div class="row">
                                            <div class="col-md-3">
                                                <a href="{{ route('item', ['category' => str_replace(' ', '-', strtolower($car->subCategory->category->name)), 'id' => base64_encode($car->id), 'name' => str_replace(' ', '-', strtolower($car->name))]) }}" title="{{$car->name}}">
                                                    <div class="crop rounded-0">
                                                        <img class="img-fluid rounded-0" src="/storage/items/{{ $car->cover }}" alt="{{$car->name}}">
                                                    </div>
                                                </a>
                                            </div>
                                            <div class="col-md-9">
                                                <a href="{{ route('item', ['category' => str_replace(' ', '-', strtolower($car->subCategory->category->name)), 'id' => base64_encode($car->id), 'name' => str_replace(' ', '-', strtolower($car->name))]) }}" title="{{$car->name}}">
                                                    <h2 class="text-dark small mt-2 text-capitalize item-name">
                                                        {{$car->name}}
                                                    </h2>
                                                </a>
                        
                                                @if($car->subCategory->category->id == 1 || $car->subCategory->category->id == 2)
                                                <div class="d-flex justify-content-between">
                                                    <h6 class="text-secondary small" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Fuel type"><i class="fa-solid fa-gas-pump"></i> @if(is_null($car->fuel_type_id)) Petrol @else {{$car->itemFuleTypes->name}} @endif</h6>
                                                    <h6 class="text-secondary small" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Transmission type"><i class="fa-solid fa-gears"></i> @if(is_null($car->transmission_id)) Manual @else {{$car->itemTransmissions->name}} @endif</h6>
                                                    @if($car->subCategory->category->id == 2)
                                                    <h6 class="text-secondary small" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Mileage"><i class="fa-solid fa-road"></i> @if(is_null($car->mileage)) 0 @else {{$car->mileage}} @endif km</h6>
                                                    @endif
                                                </div>
                                                @endif
                        
                                                @if($car->subcategory->category_id != 3)
                                                <div class="d-flex justify-content-between">
                                                    <h6 class="text-theme-red strong">{{number_format($car->price, 2)}} LKR</h6>
                                                </div>
                                                @endif
                        
                                                <div class="d-flex justify-content-between">
                                                    <h6 class="text-secondary small"><i class="fa-solid fa-location-dot"></i> {{$car->company->district->name}}</h6>
                                                    <div>
                                                        <a data-bs-toggle="tooltip" data-bs-placement="bottom" title="Share on Whatsapp" target="_blank" href="https://wa.me/?text={{ route('item', ['category' => str_replace(' ', '-', strtolower($car->subCategory->category->name)), 'id' => base64_encode($car->id), 'name' => str_replace(' ', '-', strtolower($car->name))]) }}" class="whatsapp"><i class="fa-brands fa-whatsapp"></i></a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            @endforeach

                            <div class="col-md-12 mt-2">
                                <div class="d-flex justify-content-center flex-column align-items-center w-100 py-2">
                                    <script type="text/javascript">
                                        atOptions = {
                                            'key' : '06be58498ee6db9bd2c351a50f7a7a2c',
                                            'format' : 'iframe',
                                            'height' : 90,
                                            'width' : 728,
                                            'params' : {}
                                        };
                                    </script>
                                    <script type="text/javascript" src="//www.topcreativeformat.com/06be58498ee6db9bd2c351a50f7a7a2c/invoke.js"></script>
                                </div>
                            </div>

                        </div>

                    </div>

                    <div class="col-md-3">

                        <div class="d-flex justify-content-center flex-column align-items-center w-100 py-2">
                            <script type="text/javascript">
                                atOptions = {
                                    'key' : 'ce5c292ad77ed76d918c08c54d0407bb',
                                    'format' : 'iframe',
                                    'height' : 300,
                                    'width' : 160,
                                    'params' : {}
                                };
                            </script>
                            <script type="text/javascript" src="//www.topcreativeformat.com/ce5c292ad77ed76d918c08c54d0407bb/invoke.js"></script>
                        </div>

                        <div class="d-flex justify-content-center flex-column align-items-center w-100 py-2">
                            <script type="text/javascript">
                                atOptions = {
                                    'key' : 'ce5c292ad77ed76d918c08c54d0407bb',
                                    'format' : 'iframe',
                                    'height' : 300,
                                    'width' : 160,
                                    'params' : {}
                                };
                            </script>
                            <script type="text/javascript" src="//www.topcreativeformat.com/ce5c292ad77ed76d918c08c54d0407bb/invoke.js"></script>
                        </div>

                        <div class="d-flex justify-content-center flex-column align-items-center w-100 py-2">
                            <script type="text/javascript">
                                atOptions = {
                                    'key' : 'ce5c292ad77ed76d918c08c54d0407bb',
                                    'format' : 'iframe',
                                    'height' : 300,
                                    'width' : 160,
                                    'params' : {}
                                };
                            </script>
                            <script type="text/javascript" src="//www.topcreativeformat.com/ce5c292ad77ed76d918c08c54d0407bb/invoke.js"></script>
                        </div>
                        
                    </div>

                </div>

            </div>
        </div>

    </div>

    @include('includes.main_footer')    

@endsection

@section('contentJS')
    <script></script>
@endsection
